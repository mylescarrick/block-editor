{
  "feature": "HTML Preview & Import Modal",
  "summary": "Add an HTML Preview tab to view rendered document output with Tailwind styling, plus a modal for importing HTML content via paste or text input.",
  "requirements": [
    {
      "id": "html-renderer-001",
      "category": "functional",
      "priority": 1,
      "description": "Create reusable block-to-HTML rendering utility",
      "steps": [
        "Create new file at src/lib/html-renderer.ts",
        "Export blockToHtml(block: Block, getBlock: (id: string) => Block | undefined): string function",
        "Handle all 8 block types: paragraph, heading, quote, image, code, divider, callout, columns",
        "For columns block: recursively call blockToHtml for child blocks using getBlock lookup",
        "Apply Tailwind classes for styling: headings (text-3xl/2xl/xl font-bold), paragraphs (text-base), quotes (border-l-4 pl-4 italic), code (bg-gray-900 text-gray-100 p-4 rounded font-mono), etc.",
        "Use semantic HTML elements: h1-h3, p, blockquote with cite, figure with figcaption, pre with code, hr, aside for callout",
        "Export documentToHtml(document: BlockDocument): string that iterates rootBlockIds and joins block HTML"
      ],
      "passes": true,
      "notes": "Pure functions, no React dependencies. getBlock callback enables column child lookups without coupling to store."
    },
    {
      "id": "html-preview-component-002",
      "category": "functional",
      "priority": 1,
      "description": "Create HtmlPreview component for rendered document view",
      "steps": [
        "Create new file at src/components/html-preview.tsx",
        "Accept document: BlockDocument prop",
        "Call documentToHtml() to generate full HTML string",
        "Render HTML using dangerouslySetInnerHTML in a styled container div",
        "Apply prose-like base styles to container for consistent typography",
        "Add visual distinction from editor (e.g., subtle background, border, or shadow)"
      ],
      "passes": true,
      "notes": "Follow pattern from json-preview.tsx. No copy button needed per requirements.",
      "dependsOn": ["html-renderer-001"]
    },
    {
      "id": "html-preview-tab-003",
      "category": "functional",
      "priority": 2,
      "description": "Add Preview tab to block editor",
      "steps": [
        "Import HtmlPreview component in block-editor.tsx",
        "Add third TabsTrigger with value='preview', Eye icon from lucide-react, label 'Preview'",
        "Add corresponding TabsContent rendering <HtmlPreview document={document} />",
        "Position tab between Editor and Structure for logical flow"
      ],
      "passes": true,
      "notes": "Minimal change to existing tab structure.",
      "dependsOn": ["html-preview-component-002"]
    },
    {
      "id": "html-renderer-tests-004",
      "category": "testing",
      "priority": 2,
      "description": "Add unit tests for HTML rendering functions",
      "steps": [
        "Create test file at src/lib/html-renderer.test.ts",
        "Test blockToHtml() for each block type: verify semantic elements and Tailwind classes",
        "Test columns block renders children recursively with correct layout styles",
        "Test documentToHtml() combines multiple blocks correctly",
        "Test edge cases: empty document, missing child blocks in columns"
      ],
      "passes": true,
      "notes": "Pure functions are easy to unit test. Use createBlock() helper for test fixtures.",
      "dependsOn": ["html-renderer-001"]
    },
    {
      "id": "html-import-modal-005",
      "category": "functional",
      "priority": 2,
      "description": "Create modal component for HTML import",
      "steps": [
        "Create new file at src/components/html-import-modal.tsx",
        "Accept props: open: boolean, onOpenChange: (open: boolean) => void, onImport: (blocks: Block[]) => void",
        "Use Radix Dialog primitives or create simple modal with overlay + centered panel",
        "Include textarea for pasting HTML content with placeholder text",
        "Add 'Import' button that calls parseHtmlToBlocks() from clipboard-parser.ts and passes result to onImport",
        "Add 'Cancel' button that closes modal",
        "Show preview count of blocks that will be created before importing"
      ],
      "passes": true,
      "notes": "Reuses existing parseHtmlToBlocks() and sanitizeHtml() - no new parsing logic needed."
    },
    {
      "id": "html-import-button-006",
      "category": "functional",
      "priority": 2,
      "description": "Add Import HTML button to editor toolbar",
      "steps": [
        "Add state for modal open/close in block-editor.tsx: const [importModalOpen, setImportModalOpen] = useState(false)",
        "Add 'Import HTML' button near 'Add block' button with FileCode or ClipboardPaste icon",
        "Render HtmlImportModal with open state and onImport callback",
        "In onImport callback: call insertGeneratedBlocks() with imported blocks, close modal",
        "Position insertion after last focused block or at end of document"
      ],
      "passes": true,
      "notes": "Leverages existing insertGeneratedBlocks() and focus tracking from clipboard paste feature.",
      "dependsOn": ["html-import-modal-005"]
    },
    {
      "id": "html-import-modal-tests-007",
      "category": "testing",
      "priority": 3,
      "description": "Add integration tests for HTML import modal",
      "steps": [
        "Test modal renders textarea and buttons when open",
        "Test onImport is called with parsed blocks when Import clicked",
        "Test modal closes when Cancel clicked",
        "Test block count preview updates as HTML is entered"
      ],
      "passes": true,
      "notes": "Tests modal logic and parseHtmlToBlocks integration without RTL. 18 tests covering callback behavior, block count preview, and edge cases.",
      "dependsOn": ["html-import-modal-005"]
    }
  ]
}
